REM STAR TRIP BY LAYER8
REM DATAINIT
REM POSITION
DIM P#(2,2)
REM SPEED
DIM M#(2)
REM ACCELARATION
DIM E#(2)
REM SINCOS TABLE
DIM S#(360)
DIM C#(360)
REM SHIP SHAPE VECTOR DATA
DIM A(100)
DIM D(2,100)
W=0
G=0
REM STAR
DIM T(100)
REM ANGLE
Z=0

REM INIT
 RESTORE ADATA
 FOR I=0 TO 100
  A(I)=READ()-7
  IF A(I) = -7 THEN BREAK
 NEXT
 W=I-1
 FOR I=0 TO 359
  S#(I)=SIN#(FLOAT#(I)*PI#/180)
  C#(I)=COS#(FLOAT#(I)*PI#/180)
 NEXT
 FOR I=0 TO 1
  P#(I,0)=50.0:P#(I,1)=100.0
 NEXT
 M#(0)=0.0:M#(1)=0.0
 FOR J=0 TO W
  T(J) = RND()%200
 NEXT
 Z=90
 G=0
REM MAINLOOP
 GOSUB PTINIT
 WHILE 1
  GOSUB PTSTAR
  GOSUB MVSHIP
  GOSUB PTSHIP
  G=1-G
 WEND

LABEL PTINIT
 GCLS
 WIDTH 40,2
 GPRINT 40,80,7,0,"STAR TRIP 0.2"
 GPRINT 24,110,7,0,"PUSH START BUTTON"
 WHILE KEYS(16)=0:WAIT 1:Q=RND():WEND
 GCLS
 RETURN

LABEL MVSHIP
 K=KEYS()
 IF K=8 THEN Z=(Z+359)%360
 IF K=4 THEN Z=(Z+1)%360
 IF K=1 THEN
    M#(0)=M#(0)+C#(Z)*0.001
    M#(1)=M#(1)+S#(Z)*0.001
 ENDIF
 IF K=2 THEN 
REM   M#(0)=M#(0)-C#(Z)*0.001
REM   M#(1)=M#(1)-S#(Z)*0.001
 ENDIF 
 P#(G,0)= P#(G,0) + M#(0)
 P#(G,1)= P#(G,1) - M#(1)
 FOR I=0 TO 1
  IF P#(G,I) < 0 THEN P#(G,I) = 199
  IF P#(G,I) > 199 THEN P#(G,I) = 0
 NEXT
 RETURN

LABEL PTSTAR
 FOR I = 0 TO W
  PSET T(I),T(I+1),1
  I = I+1
 NEXT
 RETURN

LABEL PTSHIP
  FOR J = 0 TO W
   D(G,J) = INT(FLOAT#(A(J)) * C#((Z+270)%360) + FLOAT#(A(J+1)) * S#((Z+270)%360))
   D(G,J+1) = INT(FLOAT#(0 - A(J)) * S#((Z+270)%360) + FLOAT#(A(J+1)) * C#((Z+270)%360))
   PSET D(1-G,J)+INT(P#(1-G,0)), D(1-G,J+1)+INT(P#(1-G,1)), 0
   PSET D(G, J)+INT(P#(G,0)), D(G,J+1)+INT(P#(G,1)), 7
   J=J+1
  NEXT
 RETURN

LABEL ADATA
DATA 7,1,7,2,6,3,8,3,6,4,8,4,5,5,9,5,5,6,9,6,5,7,9,7,5,8,9,8,5,9,9,9,5,10,9,10,5,11,9,11,5,12,9,12,5,13,9,13,4,11,5,11,9,11,10,11,3,12,11,12,4,12,10,12,3,13,5,13,7,13,9,13,10,13,11,13,0,0
